#! /bin/bash

function fn_main()
{
    filelist=${@:2}

    case $1 in
    '?'|h*)
        echo "Usage: $0 {?|help|commit|pull|revert} file..."
        ;;

    A*)
        git status | grep --color "\.swp$" && { echo "error: .swp files exist!!!";exit ;}
        read -p "Please input comment: "

        git add -A
        git commit -m "$REPLY"
        git push origin master
        ;;

    c*)
        # add commit push 指定文件...
        local i=
        for i in ${filelist}; do
            [ ! -f "$i" ] && { echo "Error: $i not exist"; exit ;}
        done

        read -p "Please input comment: "

        git add ${filelist}
        git commit -m "$REPLY" ${filelist}
        git push origin master
        ;;

    p*)
        # 解决自动merge
        # git config branch.master.remote origin
        # git config branch.master.merge refs/heads/master
        git pull origin master
        ;;

    P*|Push)
        # Your branch is ahead of 'origin/master' by 4 commits.
        git pull origin
        ;;

    s*|revert)
        [ -z "$filelist" ] && echo "Error: file... must be dedicated" && exit
        git checkout -- $filelist
        ;;

    s*|*)
        git status
        ;;
    esac

}

fn_main $@
