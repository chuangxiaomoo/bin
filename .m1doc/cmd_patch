/* */

*7* diff 
    $diff 
    $patch [options] [originalfile [patchfile]]
    /* default
     * diff old new > old.patch
     * the patch file generated by default option have no reversed patch function.
     * if do it compulsively, it doesn't work well.
     */
    [root@localhost new]# diff old new > old.patch
    [root@localhost new]# patch old < old.patch
    patching file old
    [root@localhost new]# patch new old.patch
    patching file new
    /* -u	-R
     * diff -u old1 new1 > old1.patch
     * compared with the former, this file can provide reversed patch but
     * it will generate the [patchfile.]orig at the same time.
     *
     * if patch the new file, the clue will pop up, to disable the clue, 
     * patch -R new1 < old1.patch
     */
    [root@localhost new]# diff -u old1 new1  > old1.patch
    [root@localhost new]# patch new1 < old1.patch
    patching file new1
    Reversed (or previously applied) patch detected!  Assume -R

    /* -d, -pnum & default
     * command patch patch the file or dir when the originalfile or dir 
     * are not specified. so 
     * patch old < old.patch		<==>	patch < old.patch
     * patch -p0 < old_dir.patch		<==>	patch -d ./ -p0 < old_dir.patch
     *
     * patch -d DIR_old -p1 < DIR_old.patch <==> 
     * 	cd DIR_old && patch -p1 < /absolute_path_of_patchfile/DIR_old.patch
     */ 
    /* patch without a intermediate file, but only the tar support the stdin &
     * stdout, but we can use pipe to realize what we want.
     *
     * diff -Nuar old_dir new_dir | patch -d $p_old_dir -pNum
     * diff -Nuar ~/t/a ~/t/b/a/ | patch -d /root/t/b/a -p4		
     *
     * note: when old_dir & new_dir in the same file folder, it's easy to go aw'ry:
     * diff -Nuar a b | patch -p0, so we use a -d always when patch directory.
     */

    /* when use the absolute_path, we can reference the below file
     */
    int file_patch_sh()
    {
        #! /bin/sh
        old_dir=
        new_dir=

        patch_gsdvs() {
            # diff -Nuar $old_dir $new_dir |  patch -d $old_dir -p6
            diff -Nuar $old_dir $new_dir |  patch -d / -p1
        }
    }
